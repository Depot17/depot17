---
import BaseLayout from '../../components/BaseLayout.astro';
import { Octokit } from "@octokit/core";

const title = "Depot Devlogs";

export async function getStaticPaths() {
  const octokit = new Octokit({
    auth: import.meta.env.GITHUB_TOKEN
  });

  const { data:repos } = await octokit.request('GET /orgs/{org}/repos', {
    org: 'BUILDERS-DEPOT',
    headers: {
      'X-GitHub-Api-Version': '2022-11-28'
  }
  });

  const paths = repos.map( repo => ({
      params: { devlogs: repo.name }

  }));
  return paths;
}

const { devlogs } = Astro.params
---

<BaseLayout title={title}>
    <h1>{devlogs}</h1>
    
    <!-- <script src="../DevlogsLayout.js"></script> -->
</BaseLayout>